# Java 中将简单循环转换为函数式风格（Converting Simple Loops）

## 命令式与函数式风格
早期版本的 Java 支持面向对象范式与命令式编程风格的混合。从 Java 8 开始，您还可以在代码中混合使用函数式编程风格。如果您的代码库是在 Java 7 或更早版本时期开始创建的，或者是由主要熟悉早期 Java 版本的程序员创建的，那么它将充满命令式风格的代码。
命令式风格是我们告诉程序做什么以及如何去做。函数式风格本质上是声明性的，我们告诉程序做什么，并将如何做或细节委托给底层库。命令式风格的代码可能更容易编写，因为我们大多数人都非常熟悉它。然而，代码会变得冗长、复杂且难以阅读。函数式风格一开始可能会很难，主要是因为大多数程序员不太熟悉它。一般来说，它更容易阅读、理解和更改。通过练习，它也会变得更容易编写。
在本教程系列中，我们将查看一些常见的命令式风格代码，并找到一个映射或等效的函数式风格代码来替代它。当您处理自己的代码库时，当您准备修复一个错误或进行增强时，您可能会发现将一些命令式风格的代码重构为函数式风格很有用。您可以使用本教程作为指南，为一些常见情况找到命令式到函数式风格的映射。
在本教程中，我们将重点关注简单循环。

## 简单的`for`循环
让我们从传统的`for`循环开始，在这个循环中，我们对一个范围内的索引值执行一个操作。
```java
for (int i = 0; i < 5; i++) {
  System.out.println(i);
}
```
在上面的代码中，本质是范围，从`0`到比`5`小`1`。仪式，即来自如何做的噪音，是语法加上对索引变量`i`的递增操作。我们可以保留本质并通过将代码转换为函数式风格来去除仪式。
如果您喜欢使用函数式风格来编写这个`for`循环，您可以很容易地做到，线索就在代码前面的句子中：在一个范围内迭代。由于我们正在一个范围内迭代，`IntStream`的`range`方法是直接等效的。
```java
import java.util.stream.IntStream;

...
IntStream.range(0, 5)
 .forEach(i -> System.out.println(i));
```
您可以通过使用`println`方法的方法引用来进一步简化此代码。
```java
import java.util.stream.IntStream;

...
IntStream.range(0, 5)
 .forEach(System.out::println);
```
函数式风格的代码更简洁，更易于阅读，并且此版本中的意图比命令式版本更清晰。
如果您的`for`循环运行到包括结束值，就像下面的代码一样，您可能会想知道该怎么办。
```java
for (int i = 0; i <= 5; i++) {
  System.out.println(i);
}
```
`IntStream`接口已经为您考虑到了，它有一个`rangeClosed`方法正是为此目的而设计的。
```java
import java.util.stream.IntStream;

...
IntStream.rangeClosed(0, 5)
 .forEach(System.out::println);
```
`rangeClosed`方法对于从起始值一直迭代到包括结束值非常有用。
无论您使用`range`方法还是`rangeClosed`方法，您都会获得一个`int`值的流，您可以使用内部迭代器在其上执行操作。在本系列的后面，我们将查看超出`forEach`的操作。
在前面的代码示例中，内部迭代器减轻了您迭代的负担。流负责一次一步地遍历值的范围。您只需要关注对每个元素要做什么，因为它们会在`forEach`方法中提供给您。在我们的示例中，我们只是打印提供的值。您可以执行任何您喜欢的操作，例如将信息保存到数据库，将其发送到远程服务等。
与`for`循环提供的外部迭代器不同，使用内部迭代器的代码更简洁，噪音更少，避免了显式地修改索引变量，更易于阅读，更易于修改，并且更易于使用。
继续在您自己的代码库中寻找机会，看到传统的`for`循环，并将其修改为使用`IntStream`的`range`或`rangeClosed`方法。确保在更改后验证代码是否按预期工作，最好通过运行您可能已经拥有的自动化测试。

## 映射
在任何您看到简单的`for`循环的地方，您都可以使用`IntStream`的`range`或`rangeClosed`方法。如果您想迭代到但不包括结束值，请使用`range`方法。如果您想在迭代中也包括结束值，请使用`rangeClosed`方法。