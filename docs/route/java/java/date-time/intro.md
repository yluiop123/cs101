# 日期时间 API 概述

## 日期时间 API 概述

### 介绍日期时间 API
时间似乎是一个简单的主题；即使是一块便宜的手表也能提供相当准确的日期和时间。然而，仔细观察后，您会意识到影响您对时间理解的微妙复杂性和许多因素。例如，在 1 月 31 日上加一个月的结果在闰年与其他年份是不同的。时区也增加了复杂性。例如，一个国家可能会在短时间内通知进入或退出夏令时，或者一年不止一次，或者在某一年完全跳过夏令时。

日期时间 API 使用 ISO - 8601 中定义的日历系统作为默认日历。这个日历基于公历系统，被全球用作表示日期和时间的事实上的标准。日期时间 API 的核心类有诸如`LocalDateTime`、`ZonedDateTime`和`OffsetDateTime`等名称。所有这些都使用 ISO 日历系统。如果您想使用替代日历系统，如伊斯兰历或泰国佛教历，`java.time.chrono`包允许您使用预定义的日历系统之一。或者您可以创建自己的日历系统。

日期时间 API 使用 Unicode 通用区域数据存储库（CLDR）。这个存储库支持世界上的语言，并包含世界上最大的区域数据集合。这个存储库中的信息已经被本地化为数百种语言。日期时间 API 还使用时区数据库（TZDB）。这个数据库提供了自 1970 年以来全球每个时区变化的信息，以及自该概念引入以来主要时区的历史记录。

### 日期时间设计原则
日期时间 API 是使用几个设计原则开发的。

**清晰**：API 中的方法定义明确，其行为清晰且可预期。例如，使用空参数值调用日期时间方法通常会触发`NullPointerException`。

**流畅**：日期时间 API 提供了流畅的接口，使代码易于阅读。因为大多数方法不允许空值参数且不返回空值，所以方法调用可以链接在一起，并且生成的代码可以快速理解。例如：
```java
LocalDate today = LocalDate.now(); 
LocalDate payday = today.with(TemporalAdjusters.lastDayOfMonth()).minusDays(2); 
```

**不可变**：日期时间 API 中的大多数类创建的对象是不可变的，这意味着在对象创建后，它不能被修改。要更改不可变对象的值，必须构造一个新对象作为原始对象的修改副本。这也意味着日期时间 API 定义上是线程安全的。这影响了 API，因为用于创建日期或时间对象的大多数方法都以`of`、`from`或`with`为前缀，而不是构造函数，并且没有`set`方法。例如：
```java
LocalDate dateOfBirth = LocalDate.of(2012, Month.MAY, 14);
LocalDate firstBirthday = dateOfBirth.plusYears(1); 
```

**可扩展**：日期时间 API 在任何可能的地方都是可扩展的。例如，您可以定义自己的时间调整器和查询，或构建自己的日历系统。

### 日期时间包
日期时间 API 由主要包`java.time`和四个子包组成：

- `java.time`：表示日期和时间的 API 的核心。它包括用于日期、时间、日期和时间组合、时区、瞬间、持续时间和时钟的类。这些类基于 ISO - 8601 中定义的日历系统，是不可变的且线程安全的。
- `java.time.chrono`：表示默认 ISO - 8601 以外的日历系统的 API。您也可以定义自己的日历系统。本教程不详细介绍此包。
- `java.time.format`：用于格式化和解析日期和时间的类。
- `java.time.temporal`：扩展 API，主要供框架和库编写者使用，允许日期和时间类之间的互操作、查询和调整。字段（`TemporalField`和`ChronoField`）和单位（`TemporalUnit`和`ChronoUnit`）在这个包中定义。
- `java.time.zone`：支持时区、时区偏移和时区规则的类。如果使用时区，大多数开发人员只需要使用`ZonedDateTime`、`ZoneId`或`ZoneOffset`。

### 方法命名约定
日期时间 API 在丰富的类中提供了丰富的方法。方法名称在类之间尽可能保持一致。例如，许多类提供了一个`now`方法，用于捕获与该类相关的当前时刻的日期或时间值。有`from`方法允许从一个类转换到另一个类。

关于方法名称前缀也有标准化。因为日期时间 API 中的大多数类是不可变的，所以 API 不包括`set`方法。（在创建后，不可变对象的值不能更改。`set`方法在不可变对象中的等效方法是`with`。）下表列出了常用的前缀：
|前缀|方法类型|用途|
|---|---|---|
|`of`|静态工厂|创建一个实例，其中工厂主要验证输入参数，而不是转换它们。|
|`from`|静态工厂|将输入参数转换为目标类的实例，这可能涉及丢失输入中的信息。|
|`parse`|静态工厂|解析输入字符串以生成目标类的实例。|
|`format`|实例|使用指定的格式化程序将时态对象中的值格式化为字符串。|
|`get`|实例|返回目标对象状态的一部分。|
|`is`|实例|查询目标对象的状态。|
|`with`|实例|返回目标对象的副本，其中一个元素已更改；这是 JavaBean 中`set`方法的不可变等效方法。|
|`plus`|实例|返回目标对象的副本，其中添加了一定的时间。|
|`minus`|实例|返回目标对象的副本，其中减去了一定的时间。|
|`to`|实例|将此对象转换为另一种类型。|
|`at`|实例|将此对象与另一个对象组合。|