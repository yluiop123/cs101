# Java I/O 概念介绍

## Java I/O API 简介

"Java I/O" 中的 I/O 代表输入/输出。Java I/O API 提供了所有工具，供应用程序访问外部信息。对于应用程序来说，"外部" 包括两个要素：磁盘或更广泛地讲，文件系统（文件系统并不总是模拟磁盘，例如，它们可能位于内存中），以及网络。事实证明，你可以使用 Java I/O 及其扩展访问第三个要素：堆外内存。

使用 Java I/O API，你可以读写文件，也可以通过网络使用不同协议发送和接收数据。提供数据库访问的 API（Java 数据库连接 API）使用 Java I/O API 通过 TCP/IP 访问数据库。有许多众所周知的 API 是基于 Java I/O API 构建的。

## 理解 Java I/O、Java NIO 和 Java NIO2

Java I/O API 是在 90 年代中期随着 JDK 的最初版本一起创建的。

2002 年，随着 Java SE 1.4 的发布，Java NIO 问世，带来了新的类、概念和特性。NIO 代表非阻塞输入/输出，这概括了这个扩展带来的主要特性。Java NIO 的发布并没有真正改变应用程序使用 Java I/O 的方式。你可能会想重写一些 I/O 代码，以利用 Java NIO 带来的改进，但 Java I/O 模式保持不变。

2011 年，随着 Java SE 7 的发布，Java NIO2 问世，带来了更多的类和概念。它还为 Java I/O 带来了新的模式。Java NIO2 的一些类在 Java SE 8 中进行了更新，为 Java I/O 带来了更多的模式。

本 Java I/O 教程涵盖了 API 的三个部分：Java I/O、Java NIO 和 Java NIO2。

## 访问文件

Java I/O 中有两个主要概念：定位你需要访问的资源（它可以是文件或网络资源），以及打开到该资源的流。在接下来的部分中，你将看到如何从文件系统中访问文件，以及 Java I/O API 是如何组织流的。

Java I/O API 提供了两种访问文件的方式：第一种使用 `File` 类，第二种使用 `Path` 接口。

`File` 类是在 Java SE 1.0 中引入的：它代表了访问文件的传统方式。你可以将这个类看作是一个字符串的包装器，表示你默认文件系统中的路径。路径可以是绝对路径或相对路径，可以表示常规文件或目录。你可以检查此文件是否存在，是否可以读取或修改它。你还可以对这个文件执行操作：创建它，复制它，或检查其内容。

从 Java SE 7 开始，`Path` 接口被引入，作为 Java NIO2 API 的一部分。这个接口的作用是解决 `File` 类存在的几个问题：

- `File` 类的许多方法在失败时不抛出异常，这使得无法获得有用的错误消息。
- 重命名方法在不同平台上的行为不一致。
- 没有真正的符号链接支持。
- 更希望支持元数据，如文件权限、文件所有者和其他安全属性。
- 访问文件元数据效率低下。
- `File` 方法中的许多方法不扩展。请求一个大目录列表可能会在服务器上导致挂起。大目录还可能导致内存资源问题，从而导致服务拒绝。
- 无法编写可靠的代码，以递归遍历文件树，并在存在循环符号链接时适当响应。

`Path` 接口解决了所有这些问题。因此，不再推荐使用 `File` 类。

本教程有一个部分介绍如何将旧式的 `File` 代码重构为使用 `Path` 接口。

## 理解 I/O 流

I/O 流表示输入源或输出目的地。流可以代表许多不同类型的源和目的地，包括磁盘文件、设备、其他程序和内存数组。

流支持许多不同类型的数据，包括简单的字节、原始数据类型、本地化字符和对象。一些流只是传递数据；其他流以有用的方式操作和转换数据。

无论它们内部如何工作，所有流都向使用它们的程序呈现相同的简单模型：流是数据序列。程序使用输入流从源逐个读取数据，使用输出流将数据逐个写入目的地。

数据源和数据目的地可以是任何持有、生成或消费数据的东西。显然这包括磁盘文件，但源或目的地也可以是另一个程序、外围设备、网络套接字或数组。

I/O 流与 Java SE 8 中引入的 Stream API 中的流是不同的概念。即使名称相同，可能会导致混淆，但概念是不同的。

Java I/O API 为资源定义了两种内容：

- 字符内容，如文本文件、XML 或 JSON 文档。
- 字节内容，如图像或视频。

它还定义了对内容的两种操作：读取和写入。

根据这个，Java I/O API 定义了四个抽象的基类，每个类都模拟一种 I/O 流类型和特定操作。

| 类型   | 读取           | 写入          |
| ------ | -------------- | -------------- |
| 字符流 | `Reader`       | `Writer`       |
| 字节流 | `InputStream`  | `OutputStream` |

所有字节流都从 `InputStream` 和 `OutputStream` 派生而来，它们有很多。本教程涵盖了其中的一些。

所有字符流类都从 `Reader` 和 `Writer` 派生而来。
